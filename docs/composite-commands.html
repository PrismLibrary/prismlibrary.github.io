<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Composite Commands | Prism </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Composite Commands | Prism ">
    <meta name="generator" content="docfx 2.41.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/affix.css">
    <meta property="docfx:navrel" content="../toc">
    <meta property="docfx:tocrel" content="toc">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/prism-logo.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                <ul class="nav level1 navbar-nav">
                  <li class="">
                    <a href="http://prismlibrary.github.io/" title="Home" class="">Home</a>
                  </li>
                  <li class="active">
                    <a href="../docs/index.html" title="Documentation" class="active">Documentation</a>
                  </li>
                  <li class="">
                    <a href="https://www.pluralsight.com/authors/brian-lagunas/" title="Learn" class="">Learn</a>
                  </li>
                </ul>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <a href="index.html" title="Introduction" class="">Introduction</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Getting Started</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="getting-started/Download-and-Setup-Prism.html" title="Download and Setup Prism" class="">Download and Setup Prism</a>
                          </li>
                          <li class="">
                            <a href="getting-started/NuGet-Packages.html" title="NuGet Packages" class="">NuGet Packages</a>
                          </li>
                          <li class="">
                            <a href="getting-started/productivity-tools.html" title="Productivity Tools" class="">Productivity Tools</a>
                          </li>
                        </ul>  </li>
                    <li class="">
                      <a href="commanding.html" title="Commanding" class="">Commanding</a>
                    </li>
                    <li class="active">
                      <a href="composite-commands.html" title="Composite Commands" class="active">Composite Commands</a>
                    </li>
                    <li class="">
                      <a href="event-aggregator.html" title="Event Aggregator" class="">Event Aggregator</a>
                    </li>
                    <li class="">
                      <a href="viewmodel-locator.html" title="ViewModelLocator" class="">ViewModelLocator</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">WPF</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <span class="expand-stub"></span>
                            <a class="">Legacy (Prism 6)</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="wpf/legacy/Introduction.html" title="Introduction" class="">Introduction</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Initializing.html" title="Initializing" class="">Initializing</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Managing-Dependencies.html" title="Managing-Dependencies" class="">Managing-Dependencies</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Modules.html" title="Modules" class="">Modules</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Implementing-MVVM.html" title="Implementing-MVVM" class="">Implementing-MVVM</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Advanced-MVVM.html" title="Advanced-MVVM" class="">Advanced-MVVM</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Composing-the-UI.html" title="Composing-the-UI" class="">Composing-the-UI</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Navigation.html" title="Navigation" class="">Navigation</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Communication.html" title="Communication" class="">Communication</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Deploying.html" title="Deploying" class="">Deploying</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Appendix-A-Glossary.html" title="Appendix-A-Glossary" class="">Appendix-A-Glossary</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Appendix-B-Patterns.html" title="Appendix-B-Patterns" class="">Appendix-B-Patterns</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Appendix-C-Prism-Library.html" title="Appendix-C-Prism-Library" class="">Appendix-C-Prism-Library</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Appendix-D-Extending-Prism.html" title="Appendix-D-Extending-Prism" class="">Appendix-D-Extending-Prism</a>
                                </li>
                                <li class="">
                                  <a href="wpf/legacy/Appendix-E-Click-Once.html" title="Appendix-E-Click-Once" class="">Appendix-E-Click-Once</a>
                                </li>
                              </ul>  </li>
                        </ul>  </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a class="">Xamarin.Forms</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="xamarin-forms/creating-your-first-prism-app.html" title="Create Your First App" class="">Create Your First App</a>
                          </li>
                          <li class="">
                            <span class="expand-stub"></span>
                            <a class="">Navigation</a>
                              
                              <ul class="nav level3">
                                <li class="">
                                  <a href="xamarin-forms/navigation/navigation-basics.html" title="Navigation Basics" class="">Navigation Basics</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/passing-parameters.html" title="Passing Parameters" class="">Passing Parameters</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/confirming-navigation.html" title="Confirming Navigation" class="">Confirming Navigation</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/deep-linking.html" title="Deep Linking" class="">Deep Linking</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/working-with-masterdetailpages.html" title="Working w/ MasterDetailPages" class="">Working w/ MasterDetailPages</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/working-with-navigationpages.html" title="Working w/ NavigationPages" class="">Working w/ NavigationPages</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/working-with-tabbedpages.html" title="Working w/ TabbedPages" class="">Working w/ TabbedPages</a>
                                </li>
                                <li class="">
                                  <a href="xamarin-forms/navigation/xaml-navigation.html" title="XAML Navigation" class="">XAML Navigation</a>
                                </li>
                              </ul>  </li>
                          <li class="">
                            <a href="xamarin-forms/application-lifecycle.html" title="Application Lifecycle" class="">Application Lifecycle</a>
                          </li>
                          <li class="">
                            <a href="xamarin-forms/page-lifecycle.html" title="Page Lifecycle" class="">Page Lifecycle</a>
                          </li>
                          <li class="">
                            <a href="xamarin-forms/Page-Dialog-Service.html" title="Page Dialog Service" class="">Page Dialog Service</a>
                          </li>
                          <li class="">
                            <a href="xamarin-forms/EventToCommandBehavior.html" title="EventToCommandBehavior" class="">EventToCommandBehavior</a>
                          </li>
                        </ul>  </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="composite-commands">Composite Commands</h1>

<p>In many cases, a command defined by a view model will be bound to controls in the associated view so that the user can directly invoke the command from within the view. However, in some cases, you may want to be able to invoke commands on one or more view models from a control in a parent view in the application&#39;s UI.</p>
<p>For example, if your application allows the user to edit multiple items at the same time, you may want to allow the user to save all the items using a single command represented by a button in the application&#39;s toolbar or ribbon. In this case, the Save All command will invoke each of the Save commands implemented by the view model instance for each item as shown in the following illustration.</p>
<p><img src="images/composite-commands-1.png" alt="SaveAll composite command"></p>
<p>Prism supports this scenario through the <code>CompositeCommand</code> class.</p>
<p>The <code>CompositeCommand</code> class represents a command that is composed from multiple child commands. When the composite command is invoked, each of its child commands is invoked in turn. It is useful in situations where you need to represent a group of commands as a single command in the UI or where you want to invoke multiple commands to implement a logical command.</p>
<p>The <code>CompositeCommand</code> class maintains a list of child commands (<code>DelegateCommand</code> instances). The <code>Execute</code> method of the <code>CompositeCommand</code> class simply calls the <code>Execute</code> method on each of the child commands in turn. The <code>CanExecute</code> method similarly calls the <code>CanExecute</code> method of each child command, but if any of the child commands cannot be executed, the <code>CanExecute</code> method will return <code>false</code>. In other words, by default, a <code>CompositeCommand</code> can only be executed when all the child commands can be executed.</p>
<div class="NOTE"><h5>Note</h5><p><code>CompositeCommand</code> can be found in the Prism.Commands namespace which is located in the Prism.Core NuGet package.</p>
</div>
<div class="embeddedvideo"><iframe src="https://www.youtube.com/embed/kssprOqdfME" frameborder="0" allowfullscreen="true"></iframe></div>
<h2 id="creating-a-composite-command">Creating a Composite Command</h2>
<p>To create a composite command, instantiate a <code>CompositeCommand</code> instance and then expose it as either an <code>ICommand</code> or <code>ComponsiteCommand</code> property.</p>
<pre><code class="lang-cs">    public class ApplicationCommands
    {
        private CompositeCommand _saveCommand = new CompositeCommand();
        public CompositeCommand SaveCommand
        {
            get { return _saveCommand; }
        }
    }
</code></pre><h2 id="making-a-compositecommand-globally-available">Making a CompositeCommand Globally Available</h2>
<p>Typically, CompositeCommands are shared throughout an application and need to be made available globally. It&#39;s important that when you register a child command with a <code>CompositeCommand</code> that you are using the same instance of the CompositeCommand throughout the application. This requires the CompositeCommand to be deinfed as a singleton in your application.  This can be done by either using dependency injection (DI), or by defining your CompositeCommand as a static class.</p>
<h3 id="using-dependency-injection">Using Dependency Injection</h3>
<p>The first step in defining your CompositeCommands is to create an interface.</p>
<pre><code class="lang-cs">    public interface IApplicationCommands
    {
        CompositeCommand SaveCommand { get; }
    }
</code></pre><p>Next, create a class that implements the interface.</p>
<pre><code class="lang-cs">    public class ApplicationCommands : IApplicationCommands
    {
        private CompositeCommand _saveCommand = new CompositeCommand();
        public CompositeCommand SaveCommand
        {
            get { return _saveCommand; }
        }
    }
</code></pre><p>Once you have defined your ApplicationCommands class, you must register it as a singleton with the container.</p>
<pre><code class="lang-cs">    public partial class App : PrismApplication
    {
        protected override void RegisterTypes(IContainerRegistry containerRegistry)
        {
            containerRegistry.RegisterSingleton&lt;IApplicationCommands, ApplicationCommands&gt;();
        }
    }
</code></pre><p>Next, ask for the <code>IApplicationCommands</code> interface in the ViewModel constructor.  Once you have an instance of the <code>ApplicationCommands</code> class, can now register your DelegateCommands with the appropriate CompositeCommand.</p>
<pre><code class="lang-cs">    public DelegateCommand UpdateCommand { get; private set; }

    public TabViewModel(IApplicationCommands applicationCommands)
    {
        UpdateCommand = new DelegateCommand(Update);
        applicationCommands.SaveCommand.RegisterCommand(UpdateCommand);
    }
</code></pre><h3 id="using-a-static-class">Using a Static Class</h3>
<p>Create a static class that will represent your CompositeCommands</p>
<pre><code class="lang-cs">public static class ApplicationCommands
{
    public static CompositeCommand SaveCommand = new CompositeCommand();
}
</code></pre><p>In your ViewModel, associate child commands to the static <code>ApplicationCommands</code> class.</p>
<pre><code class="lang-cs">    public DelegateCommand UpdateCommand { get; private set; }

    public TabViewModel()
    {
        UpdateCommand = new DelegateCommand(Update);
        ApplicationCommands.SaveCommand.RegisterCommand(UpdateCommand);
    }
</code></pre><div class="NOTE"><h5>Note</h5><p>To increase the maintainability and testability of your code, it is recommended that you using the dependncy injection approach.</p>
</div>
<h2 id="binding-to-a-globally-available-command">Binding to a Globally Available Command</h2>
<p>Once you have created your CompositeCommands, you must now bind them to UI elements in order to invoke the commands.</p>
<h3 id="using-depency-injection">Using Depency Injection</h3>
<p>When using DI, you must expose the <code>IApplicationCommands</code> for binding to a View.  In the ViewModel of the view, ask for the <code>IApplicationCommands</code> in the constructor and set a property of type <code>IApplicationCommands</code> to the instance.</p>
<pre><code class="lang-cs">    public class MainWindowViewModel : BindableBase
    {
        private IApplicationCommands _applicationCommands;
        public IApplicationCommands ApplicationCommands
        {
            get { return _applicationCommands; }
            set { SetProperty(ref _applicationCommands, value); }
        }

        public MainWindowViewModel(IApplicationCommands applicationCommands)
        {
            ApplicationCommands = applicationCommands;
        }
    }
</code></pre><p>In the view, bind the button to the <code>ApplicationCommands.SaveCommand</code> property. The <code>SaveCommand</code> is a property that is defined on the <code>ApplicationCommands</code> class.</p>
<pre><code class="lang-xml">&lt;Button Content=&quot;Save&quot; Command=&quot;{Binding ApplicationCommands.SaveCommand}&quot;/&gt;
</code></pre><h3 id="using-a-static-class-1">Using a Static Class</h3>
<p>If you are using the static class approach, the following code example shows how to bind a button to the static ApplicationCommands class in WPF.</p>
<pre><code class="lang-xml">&lt;Button Content=&quot;Save&quot; Command=&quot;{x:Static local:ApplicationCommands.SaveCommand}&quot; /&gt;
</code></pre><h2 id="unregister-a-command">Unregister a Command</h2>
<p>As seen in the previous examples, child commands are registered using the <code>CompositeCommand.RegisterCommand</code> method. However, when you no longer wish to respond to a CompositeCommand or if you are destroying the View/ViewModel for garbage collection, you should unregister the child commands with the <code>CompositeCommand.UnregisterCommand</code> method.</p>
<pre><code class="lang-cs">    public void Destroy()
    {
        _applicationCommands.UnregisterCommand(UpdateCommand);
    }
</code></pre><div class="IMPORTANT"><h5>Important</h5><p>You MUST unregister your commands from a <code>CompositeCommand</code> when the View/ViewModel is no longer needed (ready for GC). Otherwise you will have introduced a memory leak.</p>
</div>
<h2 id="executing-commands-on-active-views">Executing Commands on Active Views</h2>
<p>Composite commands at the parent view level will often be used to coordinate how commands at the child view level are invoked. In some cases, you will want the commands for all shown views to be executed, as in the Save All command example described earlier. In other cases, you will want the command to be executed only on the active view. In this case, the composite command will execute the child commands only on views that are deemed to be active; it will not execute the child commands on views that are not active. For example, you may want to implement a Zoom command on the application&#39;s toolbar that causes only the currently active item to be zoomed, as shown in the following diagram.</p>
<p><img src="images/composite-commands-2.png" alt="Executing a CompositeCommand on a single child"></p>
<p>To support this scenario, Prism provides the <code>IActiveAware</code> interface. The <code>IActiveAware</code> interface defines an <code>IsActive</code> property that returns <code>true</code> when the implementer is active, and an <code>IsActiveChanged</code> event that is raised whenever the active state is changed.</p>
<p>You can implement the <code>IActiveAware</code> interface on views or ViewModels. It is primarily used to track the active state of a view. Whether or not a view is active is determined by the views within the specific control. For the Tab control, there is an adapter that sets the view in the currently selected tab as active, for example.</p>
<p>The <code>DelegateCommand</code> class also implements the <code>IActiveAware</code> interface. The <code>CompositeCommand</code> can be configured to evaluate the active status of child DelegateCommands (in addition to the <code>CanExecute</code> status) by specifying <code>true</code> for the <code>monitorCommandActivity</code> parameter in the constructor. When this parameter is set to <code>true</code>, the <code>CompositeCommand</code> class will consider each child DelegateCommand&#39;s active status when determining the return value for the <code>CanExecute</code> method and when executing child commands within the <code>Execute</code> method.</p>
<pre><code class="lang-cs">    public class ApplicationCommands : IApplicationCommands
    {
        private CompositeCommand _saveCommand = new CompositeCommand(true);
        public CompositeCommand SaveCommand
        {
            get { return _saveCommand; }
        }
    }
</code></pre><p>When the <code>monitorCommandActivity</code> parameter is <code>true</code>, the <code>CompositeCommand</code> class exhibits the following behavior:</p>
<ul>
<li><code>CanExecute</code>: Returns <code>true</code> only when all active commands can be executed. Child commands that are inactive will not be considered at all.</li>
<li><code>Execute</code>: Executes all active commands. Child commands that are inactive will not be considered at all.</li>
</ul>
<p>By implementing the <code>IActiveAware</code> interface on your ViewModels, you will be notified when your view becomes active or inactive. When the view&#39;s active status changes, you can update the active status of the child commands. Then, when the user invokes the composite command, the command on the active child view will be invoked.</p>
<pre><code class="lang-cs">    public class TabViewModel : BindableBase, IActiveAware
    {
        private bool _isActive;
        public bool IsActive
        {
            get { return _isActive; }
            set
            {
                _isActive = value;
                OnIsActiveChanged();
            }
        }

        public event EventHandler IsActiveChanged;

        public DelegateCommand UpdateCommand { get; private set; }

        public TabViewModel(IApplicationCommands applicationCommands)
        {
            UpdateCommand = new DelegateCommand(Update);
            applicationCommands.SaveCommand.RegisterCommand(UpdateCommand);
        }

        private void Update()
        {
            //implement logic
        }

        private void OnIsActiveChanged()
        {
            UpdateCommand.IsActive = IsActive; //set the command as active
            IsActiveChanged?.Invoke(this, new EventArgs()); //invoke the event for al listeners
        }
    }
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix" style="margin-top: 0px;">
              <div class="connect-widget">
                <ul class="connect-links">
          		<li id="connect-github">
          			<a href="https://github.com/PrismLibrary/Prism-Documentation/blob/master/docs/composite-commands.md/#L1" target="_blank">
          				<div class="image github"></div>Edit on GitHub
          			</a>
                  </li>
                  <li id="connect-stack-overflow">
                      <a href="https://stackoverflow.com/questions/tagged/prism" target="_blank">
                          <div class="image stackoverflow"></div>Ask questions
                      </a>
                  </li>
                  <li id="connect-twitter">
                      <a href="https://twitter.com/prismlib" target="_blank">
                          <div class="image twitterhandle"></div>Follow @PrismLib
                      </a>
                  </li>
                  <li id="connect-twitter">
                      <a href="https://twitter.com/brianlagunas" target="_blank">
                          <div class="image twitterhandle"></div>Follow @BrianLagunas
                      </a>
                  </li>
                  <li id="connect-twitter">
                      <a href="https://twitter.com/danjsiegel" target="_blank">
                          <div class="image twitterhandle"></div>Follow @DanJSiegel
                      </a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright 2017 Prism
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
